<?php
/**
 * Plugin Name: Qwiz - online quizzes and flashcards
 * Plugin URI: http://dkprojects.net/qwiz
 * Description: Easy online quizzes and flashcard sets for WordPress pages
 * Version: 1.0
 * Author: Dan Kirshner
 * Author URI: http://dkprojects.net/qwiz
 * License: GPL2
 */

/*  Copyright 2014  Dan Kishner  (email : dan_kirshner@yahoo.com)

    This program is free software; you can redistribute it and/or modify
    it under the terms of the GNU General Public License, version 2, as 
    published by the Free Software Foundation.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program; if not, write to the Free Software
    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
*/

function add_qwiz_js () {
   print "<script>\n";
   print <<< 'ENDQ'

/* Qwiz/Qwizcards v1.00 
 * Initial WordPress release 2014-07-31
 */
if(! window.console){window.console={log: function(){} };}qwiz_={};var i3=function(){var s2='qwiz_';$=jQuery;var q=this;var o='div.entry-content';var e0=[];var q1=0;var c2=[];var d3;var h3=[];var m0;$(document).ready(function(){a();m2();if(e0.length){alert(k2('Error',e0.length)+' found:\n\n'+e0.join('\n'));}if(q1){$('.qwiz-feedback').hide();for(var w0=0;w0<q1;w0++){if(c2[w0] || h3[w0].o1==1){q.next_question(w0);}}}});function m2(){var d4=[];$('xmp').each(function(){d4.push($(this).html());$(this).html('');});$(o).each(function(){var n0=$(this).html();if(! n0){} else{var f3=n0.search('[qwiz]');if(f3!=-1){var y1=n0.replace(/<!--[\s\S]*?-->/gm,'');new_html=y1.replace(/\[!\][\s\S]*?\[\/!\]/gm,'');f(y1);var e3=y1.match(/\[qwiz[\s\S]*?\[\/qwiz\]/gm);if(e3){q1=e3.length;for(w0=0;w0<q1;w0++){var z1=o2(e3[w0]);y1=y1.replace(/(<[^\/][^>]*?>\s*)*?\[qwiz[\s\S]*?\[\/qwiz\]/m,z1);}}$(this).html(y1);}}});if(d4.length){$('xmp').each(function(i){$(this).html(d4[i]);});}}function a(){var s=[];s.push('<style type="text/css">\n');s.push('.qwiz {');s.push('   border:          2px solid black;');s.push('   width:           500px;');s.push('   min-height:      300px;');s.push('   padding:         5px;');s.push('}');s.push('.qwiz img {');s.push('   border:          0px;');s.push('}');s.push('div.qwiz-header {');s.push('   color:           white;');s.push('   background:      black;');s.push('   padding:         0px;');s.push('   margin:          -5px -5px 0px -5px;');s.push('}');s.push('div.qwiz-header * {');s.push('   margin:          0px;');s.push('   padding:         5px;');s.push('}');s.push('.qwiz-mode {');s.push('   font-size:       90%;');s.push('   display:         inline-block;');s.push('   margin:          0px;');s.push('   padding-left:    3px;');s.push('   padding-right:   3px;');s.push('   color:           gray;');s.push('}');s.push('.qwiz-progress {');s.push('   font-size:       90%;');s.push('   display:         inline-block;');s.push('   float:           right;');s.push('   margin:          0px;');s.push('   color:           gray;');s.push('}');s.push('.qwizq {');s.push('   display:         none;');s.push('}');s.push('.qwiz-choices p {');s.push('   padding-left:    1.6em;');s.push('   text-indent:     -1.6em;');s.push('   margin-top:      0px;');s.push('   margin-bottom:   0.5em;');s.push('}');s.push('.next_button {');s.push('   text-align:      center;');s.push('}');s.push('.qbutton {');s.push('   margin-bottom: 10px;');s.push('   border-top: 1px solid #96d1f8;');s.push('   background: #65a9d7;');s.push('   background: -webkit-gradient(linear, left top, left bottom, from(#3e779d), to(#65a9d7));');s.push('   background: -webkit-linear-gradient(top, #3e779d, #65a9d7);');s.push('   background: -moz-linear-gradient(top, #3e779d, #65a9d7);');s.push('   background: -ms-linear-gradient(top, #3e779d, #65a9d7);');s.push('   background: -o-linear-gradient(top, #3e779d, #65a9d7);');s.push('   padding: 5px 10px;');s.push('   -webkit-border-radius: 8px;');s.push('   -moz-border-radius: 8px;');s.push('   border-radius: 8px;');s.push('   -webkit-box-shadow: rgba(0,0,0,1) 0 1px 0;');s.push('   -moz-box-shadow: rgba(0,0,0,1) 0 1px 0;');s.push('   box-shadow: rgba(0,0,0,1) 0 1px 0;');s.push('   text-shadow: rgba(0,0,0,.4) 0 1px 0;');s.push('   color: white;');s.push('   font-size: 14px;');s.push('   font-weight: bold;');s.push('   font-family: arial, verdana, sans-serif;');s.push('   text-decoration: none;');s.push('   vertical-align: middle;');s.push('}');s.push('.qbutton:hover {');s.push('   border-top-color: #28597a;');s.push('   background: #28597a;');s.push('   color: #ccc;');s.push('}');s.push('.qbutton:active {');s.push('   border-top-color: #1b435e;');s.push('   background: #1b435e;');s.push('}');s.push('</style>');;$(s.join('\n')).appendTo('head');}function o2(n0){h3.push({});h3[w0].j1=0;h3[w0].m1=0;h3[w0].v0=-1;var g3=n0.match(/(<[^\/][^>]*?>\s*)*?\[qwiz[^\]]*\]/m)[0];var o1=0;var y1='';var d2=false;n0=y(n0,g3);var m=n0.match(/\[qwiz[^\]]*\]((<\/[^>]*?>\s*)*)/m,'');if(m){var z0=m[1];y1+=z0;}n0=n0.replace(/\[qwiz[^\]]*\]((<\/[^>]*?>\s*)*)/m,'');n0=b4(n0);if(n0.search(/\[q([^\]]*)\]/m)==-1){e0.push('Did not find question tags ("[q]") for qwiz '+(w0+1));} else{n0=l2(n0,w0,0,true);var b1=j2(n0,['[i]'],['[q]','[q ']);if(b1=='NA'){b1=j2(n0,['^'],['[q]','[q ']);}if(b1==''){d2=true;} else{if(n0.substr(0,5)!=b1.substr(0,5)){e0.push('Text before intro [i] - qwiz '+(w0+1));}b1=b1.replace('[i]','');y1+='<div id="intro-qwiz'+w0+'">\n'+b1+'</div>\n';}var y2=n0.match(/\[q [^\]]*\][\s\S]*|\[q\][\s\S]*/m)[0];var a3=y2.match(/\[q[^\]]*\]/gm);o1=a3.length;h3[w0].b3=new Array(o1);h3[w0].topics=[];p2(w0,a3);var f1=n0.match(/(<[^\/][^>]*?>\s*)*?\[q[ \]]/gm);var r2=[];var n1=f1.length;for(var x0=0;x0<n1;x0++){var e1=f1[x0].length;r2.push(f1[x0].substr(0,e1-3));}var r3=y2.search(/\]/)+1;var e1=y2.length;y2=y2.substring(r3,e1-7);var g0=y2.match(/\[x\]([\s\S]*)/m);if(g0){g0=g0[1];} else{g0='';}y2=y2.replace(/\[x\][\s\S]*/m,'');var c3=y2.split(/\[q [^\]]*\]|\[q\]/);var w2=[];for(var v0=0;v0<o1;v0++){w2.push(n2(w0,v0,c3[v0],r2[v0]));}y1+=w2.join('\n');}c2.push(d2);h3[w0].o1=o1;y1=v(w0,g3,y1,g0);return y1;}function y(n0,g3){n0=n0.substring(g3.length,n0.length-7);while(true){var t=n0.search(' ');if(t!=-1){break;} else{n0=atob(n0);}}n0='[qwiz]'+n0+'[/qwiz]';return n0;}function v(w0,g3,n0,g0){var m=g3.match(/\[qwiz([^\]]*)\]/m);var d=m[1];var n3=d.match(/repeat_incorrect="[^"]+"/m);h3[w0].repeat_incorrect_b=true;if(n3){var m3=n3[0];h3[w0].repeat_incorrect_b=m3.search('false')==-1;d=d.replace(m3,'');}var y3='<div id="qwiz'+w0+'" class="qwiz" '+d+'>\n';style='';if(m0=='' || m0=='NA'){style=' style="display: none;"';}y3+='<div id="header-qwiz'+w0+'" class="qwiz-header"'+ style+'>'+m0+'</div>\n';if(h3[w0].o1>1){y3+='<div>\n';var d1='Learn mode: questions repeat until answered correctly.';var w3='Test mode: incorrectly-answered questions do not repeat.';var g1;var x3;if(h3[w0].repeat_incorrect_b){g1='Learn';x3=d1+' '+w3;} else{g1='Test';x3=w3+' '+d1;}y3+='   <div id="mode-qwiz'+w0+'" class="qwiz-mode" title="'+x3+'">\n';y3+='      Mode: '+g1+'\n';y3+='   </div>\n';y3+='   <div id="progress-qwiz'+w0+'" class="qwiz-progress">\n';y3+='   </div>\n';y3+='</div>\n';}if(g0){var p3 ='    <button onclick="'+s2+'.restart_quiz ('+w0+')">\n'+'       Take the quiz again\n'+'    </button>\n';g0=g0.replace('[restart]',p3);}var e='<div id="summary-qwiz'+w0+'" class="qwizq">\n'+'    <div id="summary_report-qwiz'+w0+'">'+'    </div>\n'+     g0+'\n'+'</div>\n';e+='<div class="next_button" id="next_button-qwiz'+w0+'">\n'+'   <button class="qbutton" onclick="'+s2+'.next_question ('+w0+')">'+'<span id="next_button_text-qwiz'+w0+'">'+'Start quiz'+'</span>'+'</button>\n'+'</div>\n';e+='</div>\n';n0=y3+n0+e;return n0;}function p2(w0,a3){var p1=0;var o1=a3.length;for(var v0=0;v0<o1;v0++){var z2=a3[v0];var f1=z2.match(/\[q +([^\]]*)\]/);if(f1 && f1[1].substr(0,7)=='topic="'){var c=f1[1].substr(7);var f1=c.match(/([^"]*)"/);if(f1){var b3=b4(f1[1]);b3=b3.split(/; */);h3[w0].b3[v0]=b3;p1++;for(var i=0;i<b3.length;i++){var z3=b3[i];if(h3[w0].topics.indexOf(z3)==-1){h3[w0].topics.push(z3);}}}}}if(p1>0){ if(p1!=o1){e0.push('Topic(s) were given for at least one question, but at least one question doesn\'t have a topic.');}h3[w0].topic_statistics={};var w1=h3[w0].topics.length;for(var y0=0;y0<w1;y0++){var z3=h3[w0].topics[y0];h3[w0].topic_statistics[z3]={};h3[w0].topic_statistics[z3].j1=0;h3[w0].topic_statistics[z3].m1=0;}}}this.restart_quiz=function(w0){$('#summary-qwiz'+w0).hide();h3[w0].j1=0;h3[w0].m1=0;for(var v0=0;v0<h3[w0].o1;v0++){var j3='#qwiz'+w0+'-q'+v0;$(j3).data('answered_correctly','');}var w1=h3[w0].topics.length;for(var y0=0;y0<w1;y0++){var z3=h3[w0].topics[y0];h3[w0].topic_statistics[z3].j1=0;h3[w0].topic_statistics[z3].m1=0;}h3[w0].v0=-1;q.next_question(w0);};this.next_question=function(w0){var v0=h3[w0].v0;d3='qwiz'+w0;var o1=h3[w0].o1;if(v0==-1){if(o1>1){$('#intro-'+d3).hide();$('#next_button-qwiz'+w0).css('text-align','left');}if(o1>1){a0(w0);$('#next_button_text-'+d3).html('Next question');}} else{var j3='#'+d3+'-q'+v0;$(j3).hide();}$('#next_button-'+d3).hide();var k1=h3[w0].j1;if(! h3[w0].repeat_incorrect_b){k1+=h3[w0].m1;}if(k1==o1){c0(w0);} else{while(true){v0++;if(v0 >= o1){v0=0;}var j3='#'+d3+'-q'+v0;if(! $(j3).data('answered_correctly')){break;}}h3[w0].v0=v0;b0(w0,v0);}};function b0(w0,v0){var j3='qwiz'+w0+'-q'+v0;$('[id^='+j3+']').hide();$('#'+j3).show();$('input[name='+j3+']').removeAttr('disabled').removeAttr('checked');$('.choices-'+j3).on('mouseover',function(){$(this).css({'cursor':'pointer','color':'#045FB4'})}).on('mouseout',function(){;$(this).css({'cursor':'text','color':'black'})});}function n2(w0,v0,n0,i2){var q3=n0.search(/(<[^\/][^>]*?>\s*)*?\[c\*{0,1}\]/m);if(q3==-1){e0.push('Did not find choices ("[c]") for qwiz '+(w0+1)+', question '+(v0+1));y1='';l3='';} else{var x2=n0.substr(0,q3);var y1='<div id="qwiz'+w0+'-q'+v0+'" class="qwizq">\n'+    i2+x2;var l3=n0.substr(q3);y1+='</p><span class="qwiz-choices">';}var j=n0.match(/\[c\*{0,1}\]/gm);var i1=0;if(j){i1=j.length;}var j1=0;for(var r0=0;r0<i1;r0++){var v2=['[c]','[c*]'];var u2=['[c]','[c*]','[f]'];var g=j2(l3,v2,u2);l3=l3.substr(g.length);var k3=w(w0,v0,r0,j[r0]);j1+=k3[0];g=g.replace(/\[c\*{0,1}\]/m,k3[1]);y1+='<span class="choices-qwiz'+w0+'-q'+v0+'" onclick="'+s2+'.process_choice (\'qwiz'+w0+'-q'+v0+'-a'+r0+'\')">\n'+ g+'</span>';}y1+='</span>\n';y1+='<div style="clear: both;"></div>\n';if(j1==0){e0.push('No choice was marked correct: qwiz '+(1+w0)+', question '+(1+v0));} else if(j1>1){e0.push('More than one choice was marked correct: qwiz '+(1+w0)+', question '+(1+v0));}var j0=l3.match(/(<[^\/][^>]*?>\s*)*?\[f\][\s\S]*/m);if(! j0){e0.push('Did not find feedback ("[f]") for qwiz '+(w0+1)+', question '+(v0+1));j0='';} else{j0=j0[0].replace('[f]','');}var l0=j0.split(/\[f\]/);var l1=l0.length;if(i1!=l1){e0.push('Number of feedback items does not match number of choices: qwiz '+(1+w0)+', question '+(1+v0));}var f1=n0.match(/(<[^\/][^>]*?>\s*)*?\[f\]/gm);var h0=[];for(var t0=0;t0<l1;t0++){var e1=f1[t0].length;h0.push(f1[t0].substr(0,e1-3));}var i0=[];for(var t0=0;t0<l1;t0++){i0.push(u(w0,v0,t0,l0[t0],h0[t0]));}y1+=i0.join('\n');y1+='</div>\n';return y1;}function v3(t3){var u3='('+t3.join(')|(')+')';u3=u3.replace(/([\[\]\*])/g,'\\$1');u3='(('+u3+')\\s*)';return u3;}function j2(n0,v2,u2){var h2='(<[^/][^>]*?>\\s*)*?';var u3=h2+v3(v2);var b2=h2+v3(u2);var k='((</[^>]*?>\\s*)*)';var re=new RegExp('([\\s\\S]*?)('+u3+'[\\s\\S]*?)'+b2+k,'im');var p0=n0.match(re);var o0='';var l='';if(p0){o0=p0[2];var q0=o0.replace(/<[^>]+>/gm,'');if(q0.search(/\S/)==-1){o0='';} else{var u0=7+v2.length;var t2=p0[u0];if(t2 && t2[1]=='/'){o0+=t2;}var s0=u0+2+u2.length;var l=p0[s0];if(l){o0+=l;}}} else{o0='NA';}return o0;}function l2(n0,w0,v0,a1){var v2=['[h]'];var u2=['[q]','[q '];if(a1!=undefined){u2.push('[i]');}m0=j2(n0,v2,u2);if(m0!='NA' && m0!=''){if(n0.substr(0,5)!=m0.substr(0,5)){e0.push('Text before header [h] - qwiz '+(w0+1));}n0=n0.replace(m0,'');m0=m0.replace(/\[h\]/ig,'');}return n0;}function c0(w0){var o3=[];var o1=h3[w0].o1;var j1=h3[w0].j1;var m1=h3[w0].m1;if(h3[w0].repeat_incorrect_b){o3.push('<p><b>Congratulations, you\'re done!</b></p>');if(m1==0){o3.push('<p>In this '+f2(o1)+'-question quiz, you answered every question correctly on the first try!</p>');} else{o3.push('<p>In finishing this '+f2(o1)+'-question quiz, you entered '+f2(m1)+' incorrect '+k2('answer',m1)+'.</p>');}} else{if(m1==0){o3.push('<p>Congratulations, you answered all questions correctly.</p>');} else{o3.push('<p>Your score is '+f2(j1)+' out of '+f2(o1)+' questions.</p>');}}var w1=h3[w0].topics.length;if(w1==1){var z3=h3[w0].topics[0];var b;if(o1==2){b='Both';} else{b='All '+ f2(o1);}o3.push('<p>'+b+' '+k2('question',o1)+' were about topic &ldquo;'+z3+'.&rdquo;</p>');} else if(w1>1){o3.push('<ul>');for(var y0=0;y0<w1;y0++){var z3=h3[w0].topics[y0];var t1=h3[w0].topic_statistics[z3].j1;var u1=h3[w0].topic_statistics[z3].m1;var v1=t1+u1;if(v1>0){var a4='<li>';a4+='For topic &ldquo;'+z3+'&rdquo; there '+k2('was',v1)+' '+f2(v1)+' '+k2('question',v1)+'.&nbsp;';if(u1==0){if(v1>2){a4+='You answered all of these questions correctly';} else if(v1==2){a4+='You answered both of these questions correctly';} else{a4+='You answered this question correctly';}if(h3[w0].repeat_incorrect_b){a4+=' on the first try.';} else{a4+='.';}} else{if(h3[w0].repeat_incorrect_b){var x1=v1+u1;a4+='It took you '+f2(x1)+' '+k2('try',x1)+' to answer '+k2('this',v1)+' '+k2('question',v1)+' correctly.';} else{a4+='Your score is '+f2(t1)+' correct out of '+f2(v1)+'.';}}a4+='</li>';o3.push(a4);}}o3.push('</ul>');}$('#summary_report-qwiz'+w0).html(o3.join('\n'));$('#summary-qwiz'+w0).show();}function f(n0){var f1=n0.match(/\[qwiz|\[\/qwiz\]/gm);if(f1){var r1=f1.length;var f0=false;if(r1%2!=0){f0=true;} else{for(var i=0;i<r1;i++){var s3=f1[i];if(i%2==0){if(f1[i]!='[qwiz'){f0=true;break;}} else{if(f1[i]!='[/qwiz]'){f0=true;break;}}}}if(f0){alert('Unmatched [qwiz] - [/qwiz] pairs.');e0.push('Unmatched [qwiz] - [/qwiz] pairs.');}}}function w(w0,v0,r0,h){var n0='';var x='';var p=0;if(h=='[c*]'){x='data-correct="1" ';p=1;}n0+='<input type="radio" id="radio-qwiz'+w0+'-q'+v0+'-a'+r0+'" name="qwiz'+w0+'-q'+v0+'" '+x+' onclick="'+s2+'.process_choice (\'qwiz'+w0+'-q'+v0+'-a'+r0+'\')" />\n';return [p,n0];}this.process_choice=function(k0){var f1=k0.match(/(.*)-/);j3=f1[1];d3=k0.match(/(.*?)-/)[1];w0=parseInt(d3.substr(4));var z=$('input[name='+j3+']').attr('disabled');if(z!='disabled'){$('#'+j3+' .qwiz-feedback').hide();$('#'+k0).show();var d0=document.getElementById('radio-'+k0);d0.checked=true;$('input[name='+j3+']').attr('disabled',true);$('.choices-'+j3).on('mouseover',function(){$(this).css({'cursor':'text','color':'black'})});var r=$('#radio-'+k0).data('correct');if(r){h3[w0].j1++;$('#'+j3).data('answered_correctly',1);} else{h3[w0].m1++;if(! h3[w0].repeat_incorrect_b){$('#'+j3).data('answered_correctly',0);}}var v0=k0.match(/-q([0-9]+)-/)[1];var b3=h3[w0].b3[v0];if(b3){for(var ii=0;ii<b3.length;ii++){var z3=b3[ii];if(r){h3[w0].topic_statistics[z3].j1++;} else{h3[w0].topic_statistics[z3].m1++;}}}if(h3[w0].o1>1){a0(w0);var k1=h3[w0].j1;if(! h3[w0].repeat_incorrect_b){k1+=h3[w0].m1;}if(k1==h3[w0].o1){$('#next_button_text-'+d3).html('View summary report');}$('#next_button-'+d3).show();}}};function a0(w0){var q2;var h1=h3[w0].j1+h3[w0].m1;var k1=h3[w0].j1;if(! h3[w0].repeat_incorrect_b){k1+=h3[w0].m1;}var s1=h3[w0].o1 - k1;if(h1==0){q2='Questions in this quiz: '+s1;} else{q2=h3[w0].o1+' questions, '+h1+' '+k2('response',h1)+', '+h3[w0].j1+' correct, '+h3[w0].m1+' incorrect, '+s1+' to go';}$('#progress-'+d3).html(q2);}function u(w0,v0,t0,c1,i2){var n0='';n0+='<div class="qwiz-feedback" id="qwiz'+w0+'-q'+v0+'-a'+t0+'">\n';n0+='<hr />\n';n0+=i2+c1;n0+='<div style="clear: both;"></div>\n';n0+='</div>\n';return n0;}var g2=['zero','one','two','three','four','five','six','seven','eight','nine','ten'];function f2(e2){var c4;if(e2>9){c4=e2;} else{c4=g2[e2];}return c4;}function k2(c4,n){var a2;if(n==1){a2=c4;} else{if(c4=='was'){a2='were';} else if(c4=='this'){a2='these';} else if(c4=='try'){a2='tries';} else{a2=c4+'s';}}return a2;}function b4(s){if('a'.b4){s=s.b4();} else{s=s.replace(/^\s+|\s+$/g,'');}return s;}};i3.call(qwiz_);

if(! window.console){window.console={log: function(){} };}qcard_={};var k3=function(){var o3='qcard_';$=jQuery;var q=this;var c0='div.entry-content';var u0=[];var g2=0;var q2=[];var h0;var i0=[];var p4=[];var i2;var n4=new Object;var o4=new Object;$(document).ready(function(){c();d3();if(u0.length){alert(z2('Error',u0.length)+' found:\n\n'+u0.join('\n'));}if(g2){for(var k1=0;k1<g2;k1++){t1(k1);s1(k1);x3(k1,'front',true);if(q2[k1] || i0[k1].e2==1){q.set_next_buttons(k1);q.process_card(k1);} else{i0[k1].el_qcard_card_front.html(i0[k1].x1);}var j3=x3(k1,'front',true);v3(k1,j3);}}});function d3(){var s4=[];$('xmp').each(function(){s4.push($(this).html());$(this).html('');});$(c0).each(function(){var e1=$(this).html();if(! e1){} else{var m3=e1.search('[qdeck]');if(m3!=-1){var m2=e1.replace(/<!--[\s\S]*?-->/gm,'');m2=m2.replace(/\[!\][\s\S]*?\[\/!\]/gm,'');z(m2);var l3=m2.match(/\[qdeck[\s\S]*?\[\/qdeck\]/gm);if(l3){g2=l3.length;for(var k1=0;k1<g2;k1++){var k2=e3(l3[k1],k1);m2=m2.replace(/\[qdeck[\s\S]*?\[\/qdeck\]/m,k2);}}$(this).html(m2);}}});if(s4.length){$('xmp').each(function(i){$(this).html(s4[i]);});}}function c(){var s=[];s.push('<style type="text/css">');s.push('.qcard_window {');s.push('   position:            relative;');s.push('}');s.push('.qcard_progress {');s.push('   text-align:          right;');s.push('}');s.push('.qcard_progress p {');s.push('   font-size:           90%;');s.push('   color:               gray;');s.push('   margin:              0px;');s.push('}');s.push('div.qcard_header {');s.push('   color:           white;');s.push('   background:      black;');s.push('   margin:          0px;');s.push('   padding:         0px;');s.push('}');s.push('div.qcard_header * {');s.push('   margin:          0px;');s.push('   padding:         0px 5px 0px 5px;');s.push('}');s.push('.qcard_card {');s.push('   position:            relative;');s.push('}');s.push('.qcard_textentry {');s.push('   font-size:           13pt;');s.push('   font-weight:         bold;');s.push('   color:               blue;');s.push('}');s.push('.qcard_card .front {');s.push('   min-height:          280px;');s.push('}');s.push('.qcard_card td.center {');s.push('   padding:             5px;');s.push('   text-align:          center;');s.push('   vertical-align:      middle;');s.push('   font-size:           12pt;');s.push('   font-weight:         bold;');s.push('}');s.push('.qcard_card img {');s.push('   border:              0px;');s.push('   box-shadow:          none;');s.push('}');s.push('.qcard_card .back .center {');s.push('   background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAf4AAAE2CAIAAAAPtmerAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAEnklEQVR4nO3YMW1AMRQEwTgyf3ix9Mm8sLCLnUFw1Ra3ZuYHgJLf1wMAuE36AXKkHyBH+gFypB8gR/oBcqQfIEf6AXKkHyBH+gFypB8gR/oBcqQfIEf6AXKkHyBH+gFypB8gR/oBcqQfIEf6AXKkHyBH+gFypB8gR/oBcqQfIEf6AXKkHyBH+gFypB8gR/oBcqQfIEf6AXKkHyBH+gFypB8gR/oBcqQfIEf6AXKkHyBH+gFypB8gR/oBcqQfIEf6AXKkHyBH+gFypB8gR/oBcqQfIGf//P293gDAVWtmXm8A4CqHD0CO9APkSD9AjvQD5Eg/QI70A+RIP0CO9APkSD9AjvQD5Eg/QI70A+RIP0CO9APkSD9AjvQD5Eg/QI70A+RIP0CO9APkSD9AjvQD5Eg/QI70A+Ts883rDQBctWakH6DF4QOQI/0AOdIPkCP9ADnSD5Aj/QA50g+QI/0AOdIPkCP9ADnSD5Aj/QA50g+QI/0AOdIPkCP9ADnSD5Aj/QA50g+QI/0AOdIPkCP9ADnSD5Aj/QA5+3zzegMAV60Z6QdocfgA5Eg/QI70A+RIP0CO9APkSD9AjvQD5Eg/QI70A+RIP0CO9APkSD9AjvQD5Eg/QI70A+RIP0CO9APkSD9AjvQD5Eg/QI70A+RIP0CO9APkSD9Azj7fvN4AwFVrRvoBWhw+ADnSD5Aj/QA50g+QI/0AOdIPkCP9ADnSD5Aj/QA50g+QI/0AOdIPkCP9ADnSD5Aj/QA50g+QI/0AOdIPkCP9ADnSD5Aj/QA50g+QI/0AOdIPkLPPN683AHDVmpF+gBaHD0CO9APkSD9AjvQD5Eg/QI70A+RIP0CO9APkSD9AjvQD5Eg/QI70A+RIP0CO9APkSD9AjvQD5Eg/QI70A+RIP0CO9APkSD9AjvQD5Eg/QI70A+Ts883rDQBctWakH6DF4QOQI/0AOdIPkCP9ADnSD5Aj/QA50g+QI/0AOdIPkCP9ADnSD5Aj/QA50g+QI/0AOdIPkCP9ADnSD5Aj/QA50g+QI/0AOdIPkCP9ADnSD5Aj/QA5+3zzegMAV60Z6QdocfgA5Eg/QI70A+RIP0CO9APkSD9AjvQD5Eg/QI70A+RIP0CO9APkSD9AjvQD5Eg/QI70A+RIP0CO9APkSD9AjvQD5Eg/QI70A+RIP0CO9APkSD9Azj7fvN4AwFVrRvoBWhw+ADnSD5Aj/QA50g+QI/0AOdIPkCP9ADnSD5Aj/QA50g+QI/0AOdIPkCP9ADnSD5Aj/QA50g+QI/0AOdIPkCP9ADnSD5Aj/QA50g+QI/0AOdIPkLPPN683AHDVmpF+gBaHD0CO9APkSD9AjvQD5Eg/QI70A+RIP0CO9APkSD9AjvQD5Eg/QI70A+RIP0CO9APkSD9AjvQD5Eg/QI70A+RIP0CO9APkSD9AjvQD5Eg/QI70A+Ts883rDQBctWakH6DF4QOQI/0AOdIPkCP9ADnSD5Aj/QA50g+QI/0AOdIPkCP9ADnSD5Aj/QA50g+QI/0AOdIPkCP9ADnSD5Aj/QA50g+QI/0AOdIPkCP9ADnSD5Aj/QA5/8mNPTHI1j+2AAAAAElFTkSuQmCC);');s.push('   background-repeat:   no-repeat;');s.push('   background-size:     contain;');s.push('   background-position: center;');s.push('   min-height:          280px;');s.push('   line-height:         25px;');s.push('   font-size:           12pt;');s.push('}');s.push('.qcard_card .back .center p {');s.push('   margin-top:          25px;');s.push('   padding-top:         12.5px;');s.push('   margin-bottom:       25.5px;');s.push('}');s.push('.qcard_card .cbutton {');s.push('   display:          none;');s.push('}');s.push('.qcard_next_buttons {');s.push('   position:            relative;');s.push('   margin-top:          5px;');s.push('   text-align:          center;');s.push('}');s.push('.qbutton {');s.push('   margin-bottom: 10px;');s.push('   border-top: 1px solid #96d1f8;');s.push('   background: #65a9d7;');s.push('   background: -webkit-gradient(linear, left top, left bottom, from(#3e779d), to(#65a9d7));');s.push('   background: -webkit-linear-gradient(top, #3e779d, #65a9d7);');s.push('   background: -moz-linear-gradient(top, #3e779d, #65a9d7);');s.push('   background: -ms-linear-gradient(top, #3e779d, #65a9d7);');s.push('   background: -o-linear-gradient(top, #3e779d, #65a9d7);');s.push('   padding: 5px 10px;');s.push('   -webkit-border-radius: 8px;');s.push('   -moz-border-radius: 8px;');s.push('   border-radius: 8px;');s.push('   -webkit-box-shadow: rgba(0,0,0,1) 0 1px 0;');s.push('   -moz-box-shadow: rgba(0,0,0,1) 0 1px 0;');s.push('   box-shadow: rgba(0,0,0,1) 0 1px 0;');s.push('   text-shadow: rgba(0,0,0,.4) 0 1px 0;');s.push('   color: white;');s.push('   font-size: 14px;');s.push('   font-weight: bold;');s.push('   font-family: arial, verdana, sans-serif;');s.push('   text-decoration: none;');s.push('   vertical-align: middle;');s.push('}');s.push('.qcard_next_buttons .qbutton:hover {');s.push('   border-top-color: #28597a;');s.push('   background: #28597a;');s.push('   color: #ccc;');s.push('}');s.push('.qcard_next_buttons .qbutton:active {');s.push('   border-top-color: #1b435e;');s.push('   background: #1b435e;');s.push('}');s.push('.clear {');s.push('   clear:               both;');s.push('}');s.push('// flipCard_v2.css.');s.push('div.fc_card-container img{');s.push('        position: static !important;');s.push('}');s.push('div.card-container {');s.push('   position: relative;');s.push('   display: block;');s.push('   padding: 0;');s.push('   margin: 0;');s.push('        ');s.push('   -webkit-perspective: 1000px;');s.push('      -moz-perspective: 1000px;');s.push('        -o-perspective: 1000px;');s.push('       -ms-perspective: 1000px;');s.push('           perspective: 1000px;');s.push('}');s.push('.card-container .card {');s.push('   border-radius: 0px;');s.push('   width: 100%;');s.push('   height: 100%;');s.push('   position: absolute;');s.push('   display: inline-block;');s.push('   padding: 0;');s.push('   margin: 0;');s.push('   -webkit-transition: -webkit-transform .7s;');s.push('    -moz-transition: -moz-transform .7s;');s.push('      -o-transition: -o-transform .7s;');s.push('     -ms-transition: -o-transform .7s;');s.push('         transition: transform .7s;');s.push('   -webkit-transform-style: preserve-3d;');s.push('      -moz-transform-style: preserve-3d;');s.push('        -o-transform-style: preserve-3d;');s.push('       -ms-transform-style: preserve-3d;');s.push('           transform-style: preserve-3d;');s.push('}');s.push('.card-container .card>div{	');s.push('   border-radius: 0px;');s.push('   ');s.push('   height: 100%;');s.push('   width: 100%;');s.push('   position: absolute;');s.push('   background: #FFFFFF;');s.push('   text-align: center;');s.push('   ');s.push('   margin: 0;');s.push('   -webkit-box-sizing:border-box;');s.push('      -moz-box-sizing:border-box;');s.push('       -ms-box-sizing:border-box;');s.push('           box-sizing:border-box;');s.push('   -webkit-backface-visibility: hidden;');s.push('      -moz-backface-visibility: hidden;');s.push('        -o-backface-visibility: hidden;');s.push('       -ms-backface-visibility: hidden;');s.push('           backface-visibility: hidden;');s.push('}');s.push('.card-container .card[data-direction="top"] .back, .card-container .card[data-direction="bottom"] .back{');s.push('   -webkit-transform: rotateX(180deg);');s.push('      -moz-transform: rotateX(180deg);');s.push('        -o-transform: rotateX(180deg);');s.push('       -ms-transform: rotateX(180deg);');s.push('           transform: rotateX(180deg);');s.push('}');s.push('.card-container .card[data-direction="right"] .back, .card-container .card[data-direction="left"] .back{');s.push('        -webkit-transform: rotateY(180deg);');s.push('         -moz-transform: rotateY(180deg);');s.push('           -o-transform: rotateY(180deg);');s.push('          -ms-transform: rotateY(180deg);');s.push('              transform: rotateY(180deg);');s.push('}');s.push('.flipping-right {');s.push(' -webkit-transform: rotateY(180deg);');s.push('    -moz-transform: rotateY(180deg);');s.push('      -o-transform: rotateY(180deg);');s.push('     -ms-transform: rotateY(180deg);');s.push('         transform: rotateY(180deg);');s.push('}');s.push('.flipping-left {');s.push('   -webkit-transform: rotateY(-180deg);');s.push('    -moz-transform: rotateY(-180deg);');s.push('      -o-transform: rotateY(-180deg);');s.push('     -ms-transform: rotateY(-180deg);');s.push('         transform: rotateY(-180deg);');s.push('}');s.push('.flipping-top {');s.push('   -webkit-transform: rotateX(180deg);');s.push('      -moz-transform: rotateX(180deg);');s.push('        -o-transform: rotateX(180deg);');s.push('       -ms-transform: rotateX(180deg);');s.push('           transform: rotateX(180deg);');s.push('}');s.push('.flipping-bottom {');s.push('   -webkit-transform: rotateX(-180deg);');s.push('    -moz-transform: rotateX(-180deg);');s.push('      -o-transform: rotateX(-180deg);');s.push('     -ms-transform: rotateX(-180deg);');s.push('         transform: rotateX(-180deg);');s.push('}');s.push('.noCSS3Container{');s.push('        -webkit-perspective: none !important;');s.push('           -moz-perspective: none !important;');s.push('                 -o-perspective: none !important;');s.push('            -ms-perspective: none !important;');s.push('                        perspective: none !important; ');s.push('}');s.push('.noCSS3Card{');s.push('   -webkit-transition: none !important;');s.push('      -moz-transition: none !important;');s.push('        -o-transition: none !important;');s.push('       -ms-transition: none !important;');s.push('                    transition: none !important;');s.push('   -webkit-transform-style: none !important;');s.push('      -moz-transform-style: none !important;');s.push('        -o-transform-style: none !important;');s.push('       -ms-transform-style: none !important;');s.push('           transform-style: none !important;');s.push('}');s.push('.noCSS3Sides{');s.push('   -webkit-backface-visibility: visible !important;');s.push('      -moz-backface-visibility: visible !important;');s.push('        -o-backface-visibility: visible !important;');s.push('       -ms-backface-visibility: visible !important;');s.push('           backface-visibility: visible !important;');s.push('   -webkit-transform: none !important;');s.push('      -moz-transform: none !important;');s.push('        -o-transform: none !important;');s.push('       -ms-transform: none !important;');s.push('           transform: none !important;');s.push('}');s.push('</style>');$(s.join('\n')).appendTo('head');}function e3(e1,k1){i0.push({});i0[k1].cards=[];i0[k1].showing_front_b=true;i0[k1].i1=0;i0[k1].n_reviewed=0;i0[k1].n_got_it=0;i0[k1].w0='';var n3=e1.match(/(<[^>\/]*?>\s*)*?\[qdeck[^\]]*\]/m)[0];var g2=0;var m2='';var r2=false;e1=j0(e1,n3);var m=e1.match(/\[qdeck[^\]]*\]((<\/[^>]*?>\s*)*)/m,'');if(m){var u1=m[1];m2+=u1;}e1=e1.replace(/\[qdeck[^\]]*\]((<\/[^>]*?>\s*)*)/m,'');e1=q4(e1);if(e1.search(/\[q([^\]]*)\]/m)==-1){u0.push('Did not find question tags ("[q]") for qdeck '+(k1+1));} else{e1=c3(e1,k1,0,true);var x1=x2(e1,['[i]'],['[q]','[q ']);if(x1=='NA'){x1=x2(e1,['^'],['[q]','[q ']);}if(x1==''){r2=true;} else{if(e1.substr(0,5)!=x1.substr(0,5)){u0.push('Text before intro [i] - qdeck '+(k1+1));}x1=x1.replace('[i]','');var c4='<button class="qbutton" onclick="'+o3+'.start_deck ('+k1+')">Start reviewing cards</button>';if(x1.indexOf('[start]')!=-1){x1=x1.replace('[start]',c4);} else{x1+=c4;}i0[k1].x1=x1;}var t=e1.match(/\[q [^\]]*\][\s\S]*|\[q\][\s\S]*/m)[0];var v=t.match(/\[q[^\]]*\]/gm);var e2=v.length;i0[k1].w=new Array(e2);i0[k1].p4=[];f3(k1,v);var c2=e1.match(/(<[^>\/]*?>\s*)*?\[q[ \]]/gm);var i3=[];for(var i1=0;i1<e2;i1++){var b2=c2[i1].length;i3.push(c2[i1].substr(0,b2-3));}var b4=t.search(/\]/)+1;var b2=t.length;t=t.substring(b4,b2-8);var w0=t.match(/\[x\]([\s\S]*)/m);if(w0){var u3 ='    <button class="qbutton"'+'            onclick="'+o3+'.start_deck ('+k1+')">\n'+'       Review this flashcard stack again\n'+'    </button>\n';w0=w0[1].replace('[restart]',u3);i0[k1].w0=w0;t=t.replace(/\[x\][\s\S]*/m,'');}var x=t.split(/\[q [^\]]*\]|\[q\]/);for(var i1=0;i1<e2;i1++){h=b3(k1,i1,x[i1],i3[i1]);i0[k1].cards.push(h);}}q2.push(r2);i0[k1].e2=e2;i0[k1].n_to_go=e2;m2=f0(k1,n3);return m2;}function b3(k1,i1,e1,w2){var h=new Object;h.got_it=false;var p=w2+e1;p=p.replace(/\[a\][\s\S]*/m,'');var j2=r(p,k1);h.card_front=j2;var z0=j2!=p;var j=e1.match(/\[a\][\s\S]*/m);if(! j){u0.push('Did not find answer ("[a]") -- card back -- for qdeck '+(k1+1)+', card '+(i1+1)+'\n'+e1);j='';} else{j=j[0].substring(3);}var k=j.split(/\[a\]/);if(k.length!=1){u0.push('Got more than one card back ("[a]") for: qdeck '+(1+k1)+', card '+(1+i1)+'\n'+e1);}var b;var m=e1.match(/(<[^>\/]*?>\s*)*?\[a\]/m);if(m && m[1]){b=m[1];} else{b='';}h.card_back=e0(k1,i1,k[0],b,z0);return h;}function e0(k1,i1,e1,w2,z0){var m2=w2+e1;if(e1.search(/\[.*textentry.*/)!=-1){if(! z0){t0.push('[textentry] on back of card, but not on front - deck '+(k1+1)+', card '(i1+1));}m2=l(m2);} else{if(z0){var a3='<span id="back_textentry_clause-qdeck'+k1+'">You wrote &ldquo;<span id="back_textentry-qdeck'+k1+'" class="qcard_textentry"></span>&rdquo;<br /><br /></span>';m2=a3+'\n'+m2;}}return w2+m2;}function i4(g4){var h4='('+g4.join(')|(')+')';h4=h4.replace(/([\[\]\*])/g,'\\$1');h4='(('+h4+')\\s*)';return h4;}function x2(e1,r3,q3){var v2='(<[^/][^>]*?>\\s*)*?';var h4=v2+i4(r3);var p2=v2+i4(q3);var a0='((</[^>]*?>\\s*)*)';var re=new RegExp('([\\s\\S]*?)('+h4+'[\\s\\S]*?)'+p2+a0,'im');var g1=e1.match(re);var f1='';var b0='';if(g1){f1=g1[2];var h1=f1.replace(/<[^>]+>/gm,'');if(h1.search(/\S/)==-1){f1='';} else{var l1=7+r3.length;var p3=g1[l1];if(p3 && p3[1]=='/'){f1+=p3;}var j1=l1+2+q3.length;var b0=g1[j1];if(b0){f1+=b0;}}} else{f1='NA';}return f1;}function c3(e1,k1,m1,w1){var r3=['[h]'];var q3=['[q]','[q '];if(w1!=undefined){q3.push('[i]');}var b1=x2(e1,r3,q3);if(b1!='NA' && b1!=''){if(e1.substr(0,5)!=b1.substr(0,5)){u0.push('Text before header [h] - qdeck '+(k1+1));}e1=e1.replace(b1,'');b1=b1.replace(/\[h\]/ig,'');}i0[k1].b1=b1;return e1;}function f0(k1,n3){var m=n3.match(/\[qdeck([^\]]*)\]/m);var f=m[1];var k0='style="width: 500px; height: 300px; border: 2px solid black;"';if(! f){f=k0;} else{if(f.search(/style\s*?=/m)==-1){f=k0;} else{if(f.search('width')==-1){f=f.replace(/(style\s*?=\s*?["'])/m, '$1width: 500px;');}if(f.search('height')==-1){f=f.replace(/(style\s*?=\s*?["'])/m, '$1height: 300px;');}if(f.search('border')==-1){f=f.replace(/(style\s*?=\s*?["'])/m, '$1border: 2px solid black;');}}}var p0=[];p0.push('<div id="qcard_window-qdeck'+k1+'" class="qcard_window" style="z-index: '+(20 - k1)+';">');p0.push('   <div id="qcard_progress-qdeck'+k1+'" class="qcard_progress">');p0.push('   </div>');p0.push('   <div id="qcard_header-qdeck'+k1+'" class="qcard_header">');p0.push('   </div>');p0.push('   <div class="card-container"> ');p0.push('      <div id="qcard_card-qdeck'+k1+'" class="qcard_card card" data-direction="right"> <button class="cbutton-qdeck'+k1+' cbutton">Flip</button>');p0.push('         <div class="front">');p0.push('            <table class="qcard_table" '+f+' cellspacing="0" cellpadding="0">');p0.push('               <tr>');p0.push('                  <td class="center">');p0.push('                  </td>');p0.push('               </tr>');p0.push('            </table>');p0.push('         </div>');p0.push('         <div class="back">');p0.push('            <table class="qcard_table" '+f+' cellspacing="0" cellpadding="0">');p0.push('               <tr>');p0.push('                  <td class="center">');p0.push('                  </td>');p0.push('               </tr>');p0.push('            </table>');p0.push('         </div>');p0.push('      </div>');p0.push('   </div>');p0.push('   <div id="qcard_next_buttons-qdeck'+k1+'" + class="qcard_next_buttons">');p0.push('   </div>');p0.push('</div>');return p0.join('\n');}function f3(k1,v){var f2=0;var e2=v.length;for(var i1=0;i1<e2;i1++){var u=v[i1];var c2=u.match(/\[q +([^\]]*)\]/);if(c2 && c2[1].substr(0,7)=='topic="'){var e=c2[1].substr(7);var c2=e.match(/([^"]*)"/);if(c2){var w=q4(c2[1]);w=w.split(/; */);i0[k1].w[i1]=w;f2++;for(var i=0;i<w.length;i++){var m4=w[i];if(i0[k1].p4.indexOf(m4)==-1){i0[k1].p4.push(m4);}}}}}if(f2>0){if(f2!=e2){u0.push('Topic(s) were given for at least one card, but at least one card doesn\'t have a topic.');}i0[k1].o4={};var i2=i0[k1].p4.length;for(var o1=0;o1<i2;o1++){var m4=i0[k1].p4[o1];i0[k1].o4[m4]={};i0[k1].o4[m4].n_correct=0;i0[k1].o4[m4].n_incorrect=0;}}}this.start_deck=function(k1){i0[k1].i1=0;i0[k1].n_got_it=0;i0[k1].n_reviewed=0;var e2=i0[k1].e2;i0[k1].n_to_go=e2;q.set_next_buttons(k1);for(var p1=0;p1<e2;p1++){i0[k1].cards[p1].got_it=false;}for(var o1=0;o1<i2;o1++){var m4=i0[k1].p4[o1];i0[k1].o4[m4].n_got_it=0;}s1(k1);q.process_card(k1);};function z(e1){var c2=e1.match(/\[qdeck|\[\/qdeck\]/gm);if(c2){var h2=c2.length;var v0=false;if(h2%2!=0){v0=true;} else{for(var i=0;i<h2;i++){var f4=c2[i];if(i%2==0){if(c2[i]!='[qdeck'){v0=true;break;}} else{if(c2[i]!='[/qdeck]'){v0=true;break;}}}}if(v0){alert('Unmatched [qdeck] - [/qdeck] pairs.');u0.push('Unmatched [qdeck] - [/qdeck] pairs.');}}}function r(e1,k1){var m2=e1.replace('[textentry]','<input type="text" id="textentry-qdeck'+k1+'" class="qcard_textentry" />');return m2;}function l(e1,k1){if(e1.indexOf('id="back_textentry"')!=-1){e1=e1.replace('back_textentry','back_textentry-qdeck'+k1);} else{e1=e1.replace('textentry','<span id="back_textentry-qdeck'+k1+'" class="qdeck_textentry"></span>');}e1=e1.replace(/\[([^[]*textentry.*?)\]/,'<span id="back_textentry_clause-qdeck'+k1+'">$1</span>');return e1;}function y(){var t0=[];for(var p1=0;p1<e2;p1++){var w=cards[p1].p4;for(var ii=0;ii<w.length;ii++){m4=w[ii];if(p4.indexOf(m4)==-1){p4.push(m4);}if(! n4.hasOwnProperty(m4)){t0.push('Did not get topic/description for topic '+m4);}}}i2=p4.length;for(var o1=0;o1<i2;o1++){var m4=p4[o1];o4[m4]=new Object;o4[m4].n_got_it=0;}return t0;}function t1(k1){i0[k1].el_qcard_container=$('#qcard_window-qdeck'+k1+' div.card-container');i0[k1].el_flip=$('.cbutton-qdeck'+k1);i0[k1].el_progress=$('#qcard_progress-qdeck'+k1);i0[k1].el_header=$('#qcard_header-qdeck'+k1);i0[k1].el_qcard_card=$('#qcard_card-qdeck'+k1);i0[k1].el_qcard_card_front=$('#qcard_card-qdeck'+k1+' div.front td.center');i0[k1].el_qcard_card_back=$('#qcard_card-qdeck'+k1+' div.back  td.center');i0[k1].el_next_buttons=$('#qcard_next_buttons-qdeck'+k1);}function s1(k1){var e2=i0[k1].e2;i0[k1].card_order=new Array(e2);for(var i=0;i<e2;i++){i0[k1].card_order[i]=i;}}this.set_next_buttons=function(k1){var e1='';e1+='<button class="qbutton" onclick="'+o3+'.got_it ('+k1+')" title="Remove this card from the stack">Got it!</button> &nbsp; ';if(i0[k1].n_to_go>1){e1+='<button class="qbutton next_card-qdeck'+k1+'" onclick="'+o3+'.next_card ('+k1+')" title="Put this card at the bottom of stack, show the next card">Need more practice</button> &nbsp; ';}e1+='<button class="qbutton" onclick="'+o3+'.flip ('+k1+')" title="Show the other side">Flip</button> &nbsp; ';if(i0[k1].n_to_go>1){e1+='<button class="qbutton shuffle-qdeck'+k1+'" onclick="'+o3+'.shuffle_order ('+k1+')" title="Randomly shuffle the remaining cards">Shuffle</button> &nbsp; ';}i0[k1].el_next_buttons.html(e1);};this.process_card=function(k1){if(i0[k1].n_to_go==0){r0(k1);} else{var i1=i0[k1].i1;while(true){var p1=i0[k1].card_order[i1];if(! i0[k1].cards[p1].got_it){if(i0[k1].n_to_go==1){$('.next_card-qdeck'+k1).attr('disabled',true);$('.next_card-qdeck'+k1).css({color:'#e6e6e6',background:'#cccccc','border-top-color':'#cccccc','text-shadow':'none','box-shadow':'none'});$('.shuffle-qdeck'+k1).attr('disabled',true);$('.shuffle-qdeck'+k1).css({color:'#e6e6e6',background:'#cccccc','border-top-color':'#cccccc','text-shadow':'none','box-shadow':'none'});}i0[k1].i1=i1;i0[k1].n_reviewed++;q.set_card_front_and_back(k1);break;} else{i1++;if(i1 >= i0[k1].e2){i1=0;}}}}};function r0(k1){if(! i0[k1].showing_front_b){q.flip(k1);}i0[k1].el_progress.html('');i0[k1].el_qcard_card_back.html('');i0[k1].el_next_buttons.html('');var s3=[];if(i0[k1].n_reviewed==i0[k1].e2){s3.push('<p>In this '+t2(i0[k1].e2)+'-flashcard stack, you marked every card &lsquo;got it&rsquo; on the first try.</p>');} else{s3.push('<p>This flashcard stack had '+i0[k1].e2+' cards.  It took you '+i0[k1].n_reviewed+' tries until you felt comfortable enough to to mark &lsquo;got it&rsquo; for each card.</p>');}s3.push(i0[k1].w0);i0[k1].el_qcard_card_front.html(s3.join('\n'));}function n0(k1){var g3;g3='<p>'+i0[k1].e2+' cards total, '+i0[k1].n_reviewed+' '+z2('card',i0[k1].n_reviewed)+' reviewed, '+i0[k1].n_to_go+' '+z2('card',i0[k1].n_to_go)+' to go</p>';i0[k1].el_progress.html(g3);}this.flip=function(k1){var s0=$('#textentry-qdeck'+k1);var w3;if(i0[k1].showing_front_b){if(s0.length){s0.css('visibility','hidden');var l4=s0.val();if(l4){$('#back_textentry_clause-qdeck'+k1).show();$('#back_textentry-qdeck'+k1).html(l4);} else{$('#back_textentry_clause-qdeck'+k1).hide();}}w3='back';} else{w3='front';}x3(k1,w3);i0[k1].el_flip.trigger('click');var y3=function(){s0.css('visibility','visible');};if(! i0[k1].showing_front_b){setTimeout(y3,700);}i0[k1].showing_front_b=! i0[k1].showing_front_b;};function x3(k1,y0,r1){if(r1!=undefined){var b1=i0[k1].b1;if(b1=='' || b1=='NA'){i0[k1].el_header.hide();} else{i0[k1].el_header.html(b1);}}var j3=$('#qcard_card-qdeck'+k1+' div.'+y0+' table.qcard_table').outerWidth();i0[k1].el_progress.width(j3);i0[k1].el_header.width(j3);i0[k1].el_next_buttons.width(j3);return j3;}this.set_card_front_and_back=function(k1){var o=['card_front','card_back'];n0(k1);var i1=i0[k1].i1;var p1=i0[k1].card_order[i1];var h=i0[k1].cards[p1];for(var n1=0;n1<2;n1++){var a4=o[n1];if(a4=='card_front'){i0[k1].el_qcard_card_front.html(h[a4]);} else{i0[k1].el_qcard_card_back.html(h[a4]);}}$('#textentry-qdeck'+k1).focus();var j3=x3(k1,'front');v3(k1,j3);};function v3(k1,j3){var d1=i0[k1].el_qcard_card_front.outerHeight();var c1=i0[k1].el_qcard_card_back.outerHeight();var d2=Math.max(d1,c1);i0[k1].el_qcard_container.height(d2);i0[k1].el_qcard_container.width(j3);}this.got_it=function(k1){var i1=i0[k1].i1;var p1=i0[k1].card_order[i1];i0[k1].cards[p1].got_it=true;i0[k1].n_to_go--;q.next_card(k1);};var m0=['right','left','top','bottom'];this.next_card=function(k1){if(! i0[k1].showing_front_b){q.flip(k1);}var i=Math.floor(Math.random() * 4.0);var l2=m0[i];i0[k1].el_qcard_card.attr('data-direction',l2);i0[k1].el_qcard_card.data('direction',l2);i0[k1].i1++;if(i0[k1].i1 >= i0[k1].e2){i0[k1].i1=0;}setTimeout(o3+'.process_card ('+k1+')',375);};function j0(e1,n3){var b2=e1.length;e1=e1.substring(n3.length,e1.length-8);while(true){var d0=e1.search(' ');if(d0!=-1){break;} else{e1=atob(e1);}}e1=n3+e1+'[/qdeck]';return e1;}this.shuffle_order=function(k1){var i1=i0[k1].i1;var p1=i0[k1].card_order[i1];while(true){var n2=i0[k1].card_order[i1];if(n2!=p1 && ! i0[k1].cards[n2].got_it){break;}i0[k1].card_order=z3(i0[k1].card_order);}if(! i0[k1].showing_front_b){q.flip(k1);}i0[k1].n_reviewed--;q.process_card(k1);};function z3(d){var g0=d.length,temporaryValue,randomIndex;while(0 !== g0){randomIndex=Math.floor(Math.random() * g0);g0 -= 1;temporaryValue=d[g0];d[g0]=d[randomIndex];d[randomIndex]=temporaryValue;}return d;}var u2=['zero','one','two','three','four','five','six','seven','eight','nine','ten'];function t2(s2){var r4;if(s2>9){r4=s2;} else{r4=u2[s2];}return r4;}function z2(r4,n){var o2;if(n==1){o2=r4;} else{if(r4=='was'){o2='were';} else if(r4=='this'){o2='these';} else{o2=r4+'s';}}return o2;}function q4(s){if('a'.q4){s=s.q4();} else{s=s.replace(/^\s+|\s+$/g,'');}return s;}};k3.call(qcard_);(function($){$(document).ready(function(){var x0=false;var q0=false;var e4;var j4;var z1;var a2;function a1(){var rv=-1;if(navigator.appName=='Microsoft Internet Explorer');{var ua=navigator.userAgent;var re=new RegExp("MSIE ([0-9]{1,}[\.0-9]{0,})");if(re.exec(ua)!=null)rv=parseFloat( RegExp.$1 );}var y1=!!(navigator.userAgent.match(/Trident/) && !navigator.userAgent.match(/MSIE/));if(y1){rv=11;}return rv;}if( a1()!=-1 ){ x0=true;q0=true;}var d4=(function(){  var   o0=document.createElement('div'),vendors='Khtml Ms O Moz Webkit'.split(' '),b2=vendors.length;return function(prop){  if( prop in o0.style ) return true;prop=prop.replace(/^[a-z]/,function(val){  return val.toUpperCase();});while(b2--){  if( vendors[b2]+prop in o0.style ){  return true;}   }  return false;};})();if( !d4('backfaceVisibility') ){ x0=true;}z1=navigator.userAgent.toLowerCase().indexOf('chrome')>-1 && !!window.chrome;a2=navigator.userAgent.toLowerCase().indexOf('safari')>-1 && !window.chrome;if(z1 || a2){j4=document.createElement('div');var h3=['perspectiveProperty','WebkitPerspective'];for(var i=h3.length - 1;i >= 0;i--){e4=e4 ? e4 : j4.style[h3[i]]!=undefined;};if(! e4){x0=true;} else{var k4=document.createElement('style');k4.textContent='@media (-webkit-transform-3d){#test3d{height:3px}}';document.getElementsByTagName('head')[0].appendChild(k4);j4.id='test3d';document.body.appendChild(j4);}}setTimeout(y2,100);function y2(){if(z1 || a2){if(! x0){retOffsetHeight=j4.offsetHeight === 3;if(! retOffsetHeight){x0=true;}k4.parentNode.removeChild(k4);j4.parentNode.removeChild(j4);}}if( x0 ){jQuery('div.card-container').addClass('noCSS3Container');jQuery('.card').addClass('noCSS3Card');jQuery('.card').children('div').addClass('noCSS3Sides');jQuery('.back').hide();}$('.over').parents('.card-container').on('mouseenter',function(){$this=$(this);if(!$this.hasClass('mouseenter')){$this.addClass('mouseenter');}l0($this.find('.over'));});$('.over').parents('.card-container').on('mouseleave',function(){$this=$(this);if($this.hasClass('mouseenter')){l0($this.find('.over'));}});$('.click').on('click',function(){$this=$(this);l0($this);});$('.click').on('click','.ignoreEvent',function(e){e.stopPropagation();});$('.card').on('click','.cbutton',function(e){e.preventDefault();$this=$(this);l0($this.parents('.card'));});var v1=Array();function l0($this,q1){$this.stop(true,true);if($this.data('autoflip')!=undefined && q1!=undefined){v1[q1]=setTimeout(function(){l0($this,q1);},$this.data('autoflip'));}  if($this.data('mouse')=='true'){return;}if( x0 ){$this.find('div.front').fadeToggle();$this.find('div.back').fadeToggle();return;}if($this.data('direction') ==='right'){$this.toggleClass('flipping-right');}else if($this.data('direction') ==='left'){$this.toggleClass('flipping-left');}else if($this.data('direction') ==='top'){$this.toggleClass('flipping-top');}else if($this.data('direction') ==='bottom'){$this.toggleClass('flipping-bottom');}}var h=$('.card[data-autoflip]');function b4(){h.each(function(q1){$this=$(this);(function(c){var g=c.data('start');if(g==undefined){g=c.data('autoflip');}v1[q1]=setTimeout(function(){l0(c,q1);},g);})($this);});}b4();var t3=function(){for(var i=0;i<v1.length;i++){clearTimeout(v1[i]);}h.removeClass('flipping-right');h.removeClass('flipping-left');h.removeClass('flipping-top');h.removeClass('flipping-bottom');b4();};if(window.addEventListener){window.addEventListener('focus',t3,false);} else if(window.attachEvent){window.attachEvent('onfocus',t3);}h.on('mouseenter',function(){$(this).data('mouse','true');});h.on('mouseleave',function(){$(this).data('mouse','false');});}});})(jQuery);

ENDQ;
   print "</script>\n";
}

add_action('wp_footer', 'add_qwiz_js');
?>
